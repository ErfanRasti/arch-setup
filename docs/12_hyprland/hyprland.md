# Hyprland

Hyprland is an amazing tiling window manager. In this section I explain all the configurations I use to customize it.

First of all I should especially thank [typecraft](https://www.youtube.com/@typecraft_dev) for these amazing videos. I used them to customize my system.

**References:**

- <https://youtu.be/2CP_9-jCV6A?si=BlMLNR5JLj67ER-Y>
- <https://youtu.be/KA1jv40q9lQ?si=UxY36R0i7Y02K7xl>
- <https://youtu.be/omhJMH9lPPc?si=lRB-t1ZECN9ZB4Zr>

## Installation

The installation is so easy. Also I highly recommend you to install kitty terminal first ( as pre-requirement):

```bash
sudo pacman -S kitty
```

I prefer stick to the community repository version of `hyprland` because it is more stable:

```bash
sudo pacman -S hyprland
```

paru -S hyprland-qtutils

`hyprland-qtutils` is a package that provides some useful utilities for `hyprland`. It is recommended as a warning after openning `hyprland`. If you don't install it you get this warning:

_Your system does not have hyprland-qtutils installed. This is runtime dependency for some dialogs. Consider installing it._

It is recommended to launch hyprland on `uwsm` to make it compatible with systemd distros. So we should Install it:

```bash
paru -S uwsm
```

Now you can start `hyprland` by relogin to the systemd and choose `hyprland (uwsm-managed)` at list of your display managers and start!
In my experiance `uwsm` was so buggy and I personally prefer sticking with the default version.

At first login, you have a naive desktop manager without anything. You can launch `kitty` by pressing `<super>+Q`. Usually the resolution doesn't fit and everything is so small for `HiDPI` displays.

**Note:** Hyperland is based on wayland. Remember removing `linux_display_server x11` from `~/.config/kitty/kitty.conf`. It can cause misbehavior of `kitty` terminal.

**References:**

- <https://wiki.hyprland.org/Getting-Started/Installation/>
- <https://wiki.hyprland.org/Useful-Utilities/Systemd-start/#installation>

### Must Have

```bash
paru -S xdg-desktop-portal-hyprland-git
paru -S hyprpolkitagent-git
sudo pacman -S qt5-wayland qt6-wayland
sudo pacman -S pipewire wireplumber
```

Add `exec-once = systemctl --user start hyprpolkitagent` to `hyprland.conf`.

**References:**

- <https://wiki.hyprland.org/Useful-Utilities/Must-have/>
- <https://wiki.hyprland.org/Hypr-Ecosystem/xdg-desktop-portal-hyprland/>
- <https://wiki.hyprland.org/Hypr-Ecosystem/hyprpolkitagent/>

## Display Settings

After `kitty` has been launched you should edit `~/.config/hypr/hyprland.conf` to remove the warrning dialog at top of the display manager and also make everything work with your screen:

```bash
nano ~/.config/hypr/hyprland.conf
```

To remove the warnning dialog comment the line that starts with `autogenerated=1`.

To find your desired screen run:

```bash
hyprctl monitors all
```

Copy the name of your desired monitor (Mine was `eDP-1`); Then go back to `hyprland.conf` and add find the monitors section and add `monitor=<MONITOR_NAME>,<RESOLUTION>,<POSITION>,<SCALE>`. Mine is:

```conf
monitor=eDP-1,preferred,auto,1.25
```

### XWayland

In the above config you will encounter some bluriness in `XWayland` applications. To fix it add these lines to the `hyprland.conf`:

```conf
# change monitor to high resolution, the last argument is the scale factor
monitor = , highres, auto, 1.25

# unscale XWayland
xwayland {
  force_zero_scaling = true
}

# toolkit-specific scale
env = GDK_SCALE,2
env = XCURSOR_SIZE,32
```

#### `uwsm`

**Note:** `uwsm` should avoid using `env` in `hyprland.conf`. Instead:

```bash
mkdir -p ~/.config/uwsm/
nano ~/.config/uwsm/env
```

Add:

```sh
export GDK_SCALE=2
export XCURSOR_SIZE=32
```

And for `HYPR*` and `AQ_*`:

```bash
nano ~/.config/uwsm/env-hyprland
```

Add:

```bash
export HYPRCURSOR_SIZE=32
```

**References:**

- <https://wiki.hyprland.org/Configuring/XWayland/#hidpi-xwayland>
- <https://wiki.hyprland.org/Configuring/Environment-variables/>

## Default file manager

```bash
nano ~/.config/hypr/hyprland.conf
```

Change this line:

```conf
$fileManager = nautilus
```

## App Launcher

### `wofi`

```bash
sudo pacman -S wofi
```

To see the shortcut dedicated to it, chech the `bind` command that is dedictaed to `$menu` (If you look at the `$menu` initialization, it is mapped to `wofi`).

For more configurations you can use this custom `.css`:

```bash
mkdir -p ~/Programs/
git clone https://github.com/typecraft-dev/dotfiles.git ~/Programs/typecraft-dotfiles
cd  ~/Programs/typecraft-dotfiles
stow -t ~ wofi
```

**References:**

- <https://github.com/typecraft-dev/dotfiles/tree/master>

### `rofi`

I recommand `rofi`:

```bash
sudo pacman -S rofi
```

Customization:

1. Installation
   ```bash
   git clone --depth=1 https://github.com/adi1090x/rofi.git ~/Programs/rofi-themes/
   cd ~/Programs/rofi-themes/
   chmod +x setup.sh
   ./setup.sh
   ```
2. Change theme:
   ```bash
   mkdir -p ~/.config/rofi/applets/shared/
   nano ~/.config/rofi/applets/shared/theme.bash
   ```
   Add:
   ```conf
   type="$HOME/.config/rofi/applets/type-1"
   style='style-1.rasi'
   ```

**References:**

- <https://www.youtube.com/watch?v=TutfIwxSE_s>

## Shortcuts

I also changed some shortcuts according to my setup:

```conf
bind = $mainMod, T, exec, $terminal
bind = $mainMod, Q, killactive,
bind = $mainMod, F, togglefloating,
bind = ALT, space, exec, $menu
# bind = $mainMod, Super_L, exec, $menu
bind = $mainMod SHIFT, Q, exit,
```

`$mainMod, Super_L` means triggering the menu by just pressing the `<SUPER>` key (`$mainMod=SUPER`). `ALT+space` also is a nice combination.

**Note:** `uwsm` users should avoid using `exit` in the `hyprland.conf` according to the wiki.

```conf
bind = $mainMod SHIFT, Q, exec, uwsm stop
```

To switch between different worksapces using `SUPER+ALT+ARROWS` I used the following keybingds:

```conf
# Switch workspaces using $mainMod+Alt+Arrow keys
bind = $mainMod ALT, left, workspace, e-1
bind = $mainMod ALT, right, workspace, e+1
# Move window forward or backward
bind = $mainMod SHIFT ALT, left, movetoworkspace, e-1
bind = $mainMod SHIFT ALT, right, movetoworkspace, e+1
```

To make brightness control shortcuts work, install this package:

```bash
sudo pacman -S brightnessctl
```

I use intel in conjunction with nvidia. It should be specified to work corretly. I also chagned the percent:

```conf
bindel = ,XF86MonBrightnessUp, exec, brightnessctl -d intel_backlight s 5%+
bindel = ,XF86MonBrightnessDown, exec, brightnessctl -d intel_backlight s 5%-
```

**References:**

- <https://wiki.hyprland.org/Configuring/Keywords/>
- <https://github.com/hyprwm/Hyprland/discussions/2506>
- <https://www.reddit.com/r/hyprland/comments/1f23gdd/shortcut_for_changing_workspaces/>
- <https://wiki.hyprland.org/Configuring/Dispatchers/>

## Touchpad

Change natural scroll to `true:

```conf
touchpad {
        natural_scroll = true
    }
```

For gestures on workspaces:

```conf
gestures {
    workspace_swipe = true
}
```

## sudo apps

According to [this](https://github.com/hyprwm/Hyprland/discussions/7790), If you want to run GUI apps from terminal with `sudo`:

```bash
sudo -E <APP_NAME>
```

## Animations

To activate slide animations on workspaces go to `animations {}` and follow this:

```bash
animation = NAME, ONOFF, SPEED, CURVE [,STYLE]
```

To add `slide` animations:

```conf
animation = workspaces, 1, 2, almostLinear, slide
animation = workspacesIn, 1, 2, almostLinear, slide
animation = workspacesOut, 1, 2, almostLinear, slide
```

You can more customize it according to the [wiki](https://wiki.hyprland.org/Configuring/Animations/).

## `waybar`

```bash
sudo pacman -S waybar
```

`waybar` also needs `ttf-font-awesome`:

```bash
sudo pacman -S ttf-font-awesome
```

To configure `waybar` go to [this](https://github.com/Alexays/Waybar/blob/master/resources/config.jsonc) and copy the configuration.

Paste the configuration into this:

```bash
mkdir -p ~/.config/waybar/
nano ~/.config/waybar/config
```

You should add some configuration modules by your own. Also you should consider changing `sway` to `hyprland` in different modules.

For more configurations (as I did in `wofi`):

```bash
rm ~/.config/waybar/config
cd  ~/Programs/typecraft-dotfiles
stow -t ~ waybar
```

**References:**

- <https://github.com/Alexays/Waybar/wiki/Configuration>

## Notification

```bash
paru -S swaync
```

You can also add `swaync` to `hyprland.conf` to start at Hyprland login:

```conf
exec-once = waybar & swaync
```

But for me that wasn't necessary.

## Screenshot

```bash
paru -S hyprshot
```

To test it:

```bash
hyprshot -m window
```

You should also add some keybindings for ease of use to the `hyprland.conf`:

```conf
# Screenshot keybindings
bind = shift, PRINT, exec, hyprshot -m window
bind = , PRINT, exec, hyprshot -m region
```

## Lockscreen

```bash
paru -S hyprlock
```

Configuration:

```bash
nano ~/.config/hypr/hyprlock.conf
```

Add this configuration:

```conf
background {
    monitor =
    path = screenshot
    color = rgba(25, 20, 20, 1.0)
    blur_passes = 2
}

input-field {
    monitor =
    size = 50%, 50%
    outline_thickness = 3
    inner_color = rgba(0, 0, 0, 0.0) # no fill

    outer_color = rgba(33ccffee) rgba(00ff99ee) 45deg
    check_color=rgba(00ff99ee) rgba(ff6633ee) 120deg
    fail_color=rgba(ff6633ee) rgba(ff0066ee) 40deg

    font_color = rgb(143, 143, 143)
    fade_on_empty = false
    rounding = 15

    position = 0, -20
    halign = center
    valign = center
}
```

Bind a key for it:

```conf
bind = $mainMod, L,exec, hyprlock
```

For more configurations (as I did in `wofi`):

```bash
rm ~/.config/hypr/hyprlock.conf
cd  ~/Programs/typecraft-dotfiles
stow -t ~ hyprmocha/
stow -t ~ hyprlock
```

Make sure to change `monitor` and `path` according to your config.

**References:**

- <https://wiki.hyprland.org/Hypr-Ecosystem/hyprlock/>

## idle manager

```bash
sudo pacman -S hypridle
```

Configurations:

```bash
nano ~/.config/hypr/hypridle.conf
```

Add the configuration from [this](https://wiki.hyprland.org/Hypr-Ecosystem/hypridle/):

```conf
general {
    lock_cmd = pidof hyprlock || hyprlock       # avoid starting multiple hyprlock instances.
    before_sleep_cmd = loginctl lock-session    # lock before suspend.
    after_sleep_cmd = hyprctl dispatch dpms on  # to avoid having to press a key twice to turn on the display.
}

listener {
    timeout = 150                                # 2.5min.
    on-timeout = brightnessctl -s set 10         # set monitor backlight to minimum, avoid 0 on OLED monitor.
    on-resume = brightnessctl -r                 # monitor backlight restore.
}

# turn off keyboard backlight, comment out this section if you dont have a keyboard backlight.
listener {
    timeout = 150                                          # 2.5min.
    on-timeout = brightnessctl -sd rgb:kbd_backlight set 0 # turn off keyboard backlight.
    on-resume = brightnessctl -rd rgb:kbd_backlight        # turn on keyboard backlight.
}

listener {
    timeout = 300                                 # 5min
    on-timeout = loginctl lock-session            # lock screen when timeout has passed
}

listener {
    timeout = 330                                 # 5.5min
    on-timeout = hyprctl dispatch dpms off        # screen off when timeout has passed
    on-resume = hyprctl dispatch dpms on          # screen on when activity is detected after timeout has fired.
}

listener {
    timeout = 600                                # 10min
    on-timeout = systemctl suspend                # suspend pc
}
```

Add `hypridle` to `exec-once` on `hyprland.conf`:

**References:**

- <https://wiki.hyprland.org/Hypr-Ecosystem/hypridle/>

## Themes

It is recommended to install `nwg-look` for GTK themes:

```bash
sudo pacman -S nwg-look
```

Now open `nwg-look` and apply what theme you want.

**References:**

- <https://wiki.hyprland.org/Getting-Started/Master-Tutorial/#themes>

## Cursor

To set the cursor first you should put your theme(s) in ~/.local/share/icons or ~/.icons:

```bash
cp -rf Bibata-Modern-Classic ~/.icons
```

Then add this to the `hyprland.conf`:

```conf
exec-once = hyprctl setcursor Bibata-Modern-Classic 24
```

**References:**

- <https://wiki.hyprland.org/Hypr-Ecosystem/hyprcursor/>
- <https://www.reddit.com/r/hyprland/comments/18axtng/how_do_i_set_my_cursor_theme/>

## Powerbutton remap

1. Install `acpid` and enable `systemd-logind`:

```bash
sudo pacman -S acpid
sudo systemctl enable --now systemd-logind
```

2. Edit `logind.conf`:

```bash
sudo mkdir -p /etc/systemd/logind.conf.d/
sudo cp /etc/systemd/logind.conf /etc/systemd/logind.conf.d/
sudo nano /etc/systemd/logind.conf.d/logind.conf
```

Change:

```conf
HandlePowerKey=suspend
```

3. Restart `systemd-logind`:

```bash
sudo systemctl restart systemd-logind
```

This instruction also remapped closing the lid for me.

**References:**

- <https://www.reddit.com/r/hyprland/comments/1dym0f1/how_to_change_what_power_button_does/>

## Wallpaper

1. install `hyprpaper`:

```bash
sudo pacman -S hyprpaper
```

2. Configure it and pass your desired wallpaper to it:

```conf
nano ~/.config/hypr/hyprpaper.conf
```

For me:

```conf
preload = ~/Pictures/Wallpapers/MatrixWallpapers/trinity-matrix.png
wallpaper = eDP-1, ~/Pictures/Wallpapers/MatrixWallpapers/trinity-matrix.png
```

3. Add this at the first of your `hyprland.conf`:

```conf
exec-once = hyprpaper
```

**References:**

- <https://wiki.hyprland.org/Hypr-Ecosystem/hyprpaper/>

## Resize windows

Activate it by:

```conf
resize_on_border = true
```

**References:**

- <https://wiki.hyprland.org/Configuring/Variables/>
- <https://www.reddit.com/r/hyprland/comments/1d7djl5/might_be_a_stupid_question_but_how_do_i_resize/>

## HyprPanel

### Installation

```bash
curl -fsSL https://bun.sh/install | bash && \
  sudo ln -s $HOME/.bun/bin/bun /usr/local/bin/bun

paru -S aylurs-gtk-shell
sudo pacman -S ttf-jetbrains-mono-nerd
sudo pacman -S pipewire libgtop bluez bluez-utils btop networkmanager \
  dart-sass wl-clipboard brightnessctl swww python gnome-bluetooth-3.0 \
  pacman-contrib power-profiles-daemon gvfs sass
paru -S grimblast-git gpu-screen-recorder hyprpicker matugen-bin \
  python-gpustat hyprsunset-git hypridle-git
git clone https://github.com/Jas-SinghFSU/HyprPanel.git ~/Programs/HyprPanel
cd  ~/Programs/HyprPanel;
git pull
./make_agsv1.sh

# Moves the current ~/.config/ags directory to ~/.config/ags.bkup
mv $HOME/.config/ags $HOME/.config/ags.bkup

# Installs HyprPanel to ~/.config/ags
git clone https://github.com/Jas-SinghFSU/HyprPanel.git && \
  ln -s $(pwd)/HyprPanel $HOME/.config/ags

agsv1
```

The above commands are extracted from the wiki. I also had a `CaskaydiaCove NF` font installed. If you don't have install a `nerdfont`.

`HyprPanel` is fantastic and it aims to replace `waybar` with lots of configurations. Add it to your `hyprland.conf`:

```conf
exec-once = agsv1
```

### Configurations

For custom modules on the bar you should go to `Configurations > Bar > Layouts > Bar Layouts for Monitors` and change your `.json` file.

```json
{
  "0": {
    "left": ["dashboard", "workspaces", "windowtitle", "media"],
    "middle": ["clock"],
    "right": [
      "systray",
      "cpu",
      "cputemp",
      "ram",
      "kbinput",
      "volume",
      "bluetooth",
      "network",
      "battery",
      "notifications"
    ]
  },
  "1": {
    "left": ["dashboard", "workspaces", "windowtitle", "media"],
    "middle": ["clock"],
    "right": ["volume", "notifications"]
  },
  "2": {
    "left": ["dashboard", "workspaces", "windowtitle", "media"],
    "middle": ["clock"],
    "right": ["volume", "notifications"]
  }
}
```

This is my configurations.
Numbers are associated to monitor numbers.

#### CPU Temperature

In order to display the CPU Temperature properly, you must first determine the correct CPU sensor for your system. To do that you can use the following command:

```bash
for i in /sys/class/hwmon/hwmon*/temp*_input; do echo \
  "$(<$(dirname $i)/name): $(cat ${i%_*}_label 2>\
  /dev/null || echo $(basename ${i%_*})) \
  $(readlink -f $i)"; \
   done
```

**References:**

- <https://hyprpanel.com/getting_started/installation.html>
- <https://github.com/Jas-SinghFSU/HyprPanel>
- <https://www.youtube.com/watch?v=6Dn9k8EX0-M>
- <https://hyprpanel.com/configuration/panel.html#layouts>
- <https://hyprpanel.com/configuration/panel.html#cpu-temperature>

## gnome-control-center

Add this to `hyprland.conf`:

```conf
$settings = env XDG_CURRENT_DESKTOP=GNOME gnome-control-center
# Settings shortcut
bind = $mainMod, I, exec, $settings
```

**References:**

- <https://discourse.gnome.org/t/gnome-control-center-outside-of-gnome/15771>

## Keyboard Languages

If you want to use another keyboard language on your system, first you should find your keymap layout and your specified variant:

```bash
localectl list-x11-keymap-layouts
```

Mine is persian which is refered as `ir`. For variant:

```bash
localectl list-x11-keymap-variants ir
# Output:
# azb
# ku
# ku_alt
# ku_ara
# ku_f
# pes_keypad
# winkeys
```

I choose `winkeys` for comfortability. I also chooe `SUPER+SPACE` for changing keyboard languages. Finally you should change `hyprland.conf`:

```conf
input {
    kb_layout = us, ir
    kb_variant =,winkeys
    kb_model =
    kb_options =grp:win_space_toggle
    kb_rules =

    follow_mouse = 1

    sensitivity = 0 # -1.0 - 1.0, 0 means no modification.

    touchpad {
        natural_scroll = true
    }
}
```

**References:**

- <https://wiki.hyprland.org/Configuring/Uncommon-tips--tricks/>
- <https://unix.stackexchange.com/questions/43976/list-all-valid-kbd-layouts-variants-and-toggle-options-to-use-with-setxkbmap>
- <https://www.reddit.com/r/hyprland/comments/176algg/how_do_i_change_the_keyboard_language_in_hyprland/>
- <https://www.reddit.com/r/hyprland/comments/xtxmv8/eli5_how_do_i_change_keyboard_layout_in_hyprland/>
- <https://wiki.hyprland.org/Configuring/Variables/#input>

## PROXY

To make proxy work, add this to `hyprland.conf`:

```conf
$addr_port= 127.0.0.1:1234

env=HTTPS_PROXY=$addr_port
env=https_proxy=$addr_port
env=ALL_PROXY=$addr_port
env=all_proxy=$addr_port
env=NO_PROXY=$addr_port
env=no_proxy=$addr_port
env=http_proxy=$addr_port
env=ftp_proxy=$addr_port
env=FTP_PROXY=$addr_port
```

Relogin to work.
**Note:** Some apps like `telegram-destkop` or `zen-browser` still may need to configure proxy manually in their settings. First try system proxy in their settings. If it doesn't work, manually set the proxy to the same address and port (`$addr_port`).

If you want to remove these environment variables you can use `unset` command:

```bash
unset HTTP_PROXY HTTPS_PROXY https_proxy ALL_PROXY all_proxy NO_PROXY no_proxy http_proxy FTP_PROXY ftp_proxy
```

## Troubleshooting

### Losing Browser Session when Switching DE

This is an annoying problem. Thanks to reddit explanation:

1. Install `gnome-keyring`:

```bash
sudo pacman -S gnome-keyring
```

2. Add following to `hyprland.conf`:

```conf
exec-once = gnome-keyring-daemon --start --components=secrets
```

3. Remove `~/.local/share/keyrings` or use `Passwords & Keys` application to choose and reset it to an empty password:

```bash
rm -rf ~/.local/share/keyrings
```

When the pop up appears in GNOME, press enter and don't make any password for authentication.

**Warning:** Avoid using GNOME online accounts. It will reset the keyring password.

**References:**

- <https://www.reddit.com/r/hyprland/comments/1avevff/brave_deletes_all_sessions_after_closure_in/>
- <https://bbs.archlinux.org/viewtopic.php?id=285563>
- <https://forum.manjaro.org/t/disable-unlock-default-keyring-in-gnome/113336>

### Cannot turn on the bluetooth

```bash
rfkill unblock bluetooth
```

**References:**

- <https://stackoverflow.com/questions/68728478/failed-to-set-power-on-org-bluez-error-blocked-problem>
- <https://stackoverflow.com/questions/34709583/bluetoothctl-set-passkey>
